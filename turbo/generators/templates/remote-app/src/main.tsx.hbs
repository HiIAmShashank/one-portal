import { StrictMode } from 'react';
import { createRoot } from 'react-dom/client';
import { UnifiedAuthProvider } from '@one-portal/auth';
import { msalInstance, getAuthConfig } from './auth/msalInstance';
import { PUBLIC_ROUTES } from './config/routes';
import App from './App';

// Import CSS only in standalone mode (dev/preview)
// In production, CSS is provided by the Shell
if (import.meta.env.DEV || import.meta.env.MODE === 'preview') {
  await import('@one-portal/ui/styles.css');
}

/**
 * Standalone entry point for {{ displayName }}
 *
 * This file is used when running the app independently during development.
 * In production, the app is loaded via Module Federation (bootstrap.tsx).
 */
const container = document.getElementById('root');

if (!container) {
  throw new Error('[{{ displayName }}] Root element not found');
}

const root = createRoot(container);

root.render(
  <StrictMode>
    <UnifiedAuthProvider
      msalInstance={msalInstance}
      mode="remote"
      appName="{{ appName }}"
      getAuthConfig={getAuthConfig}
      debug={import.meta.env.DEV}
      publicRoutes={PUBLIC_ROUTES}
    >
      <App />
    </UnifiedAuthProvider>
  </StrictMode>
);
